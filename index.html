<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>현재 위치 표시</title>
  <style>
    body { margin: 0; font-family: sans-serif; }
    #map { width: 100%; height: 100vh; }
  </style>
  <!-- ✅ autoload=false 제거된 스크립트 -->
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=0b2691921f9afbc1176ef90f961da3df"></script>
</head>
<body>
  <div id="map"></div>

  <script>
    window.onload = function () {
      // 1. 기본 중심 설정 (서울 시청)
      const container = document.getElementById('map');
      const options = {
        center: new kakao.maps.LatLng(37.5665, 126.9780),
        level: 3
      };

      const map = new kakao.maps.Map(container, options);

      // 2. 사용자 위치 표시
      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(function(position) {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;

          const userPos = new kakao.maps.LatLng(lat, lng);
          console.log("현재 위치:", lat, lng);

          // 마커가 없으면 새로 생성
          if (!window.userMarker) {
            window.userMarker = new kakao.maps.Marker({
              position: userPos,
              map: map,
              title: "내 위치"
            });
          } else {
            window.userMarker.setPosition(userPos);
          }

          map.panTo(userPos);
        }, function(error) {
          alert("위치 정보를 불러올 수 없습니다: " + error.message);
        }, {
          enableHighAccuracy: true
        });
      } else {
        alert("이 브라우저는 위치 정보를 지원하지 않습니다.");
      }
    };
  </script>
</body>
</html>
